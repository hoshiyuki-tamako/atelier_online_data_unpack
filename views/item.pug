doctype html
html
  head
    title アイテム / 裝備 / 料理
    link(rel="stylesheet" href="css/reset.css")
    link(rel="stylesheet" href="css/main.css")
    link(rel="stylesheet" href="css/wealth.css")
    style.
      th {
        white-space: nowrap;
      }
      th, td {
        text-align: left;
        padding: 4px;
      }



      .category-indexes-container {
        display: flex;
        flex-wrap: wrap;
      }
      .category-index-container {
        padding: 12px;
      }



      .items-index-container {
        display: flex;
        flex-wrap: wrap;
      }
      .item-index-container {
        padding: 12px;
      }
      .item-index-container a {
        width: 120px;
        min-height: 140px;
        display: flex;
        flex-direction: column;
        padding-left: 4px;
        text-align: center;
      }
      .item-index-container > a > p {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .item-index-container > a > img {
        width: 100%;
      }



      .item-container {
        display: flex;
        padding: 12px;
      }
      .item-container-left {
        min-width: 200px;
        max-width: 200px;
        padding: 12px;
      }
      .item-container-right {
        padding: 12px;
      }

      .item-making-container {
        display: flex;
        flex-wrap: wrap;
      }
  body
    div
      h2 種類
      div.category-indexes-container
        - for(const ii of itemIndex)
          div.category-index-container
            h3
              a(href="#CATEG-" + ii.CATEG)= Option.itemCategoryLookUp[ii.CATEG] || `CATEG=${ii.CATEG}`
    br
    br
    br
    br

    div
      - for(const ii of itemIndex)
        h2(id="CATEG-" + ii.CATEG)= Option.itemCategoryLookUp[ii.CATEG] || `CATEG=${ii.CATEG}`
        div.items-index-container
          - for (const i of ii.items)
            div.item-index-container
              a(href="#DF-" + i.DF)
                p #{i.NAME}
                img(src="img/icon_s/Texture2D/icon_item_s_" + i.DF + ".png" alt= i.NAME)
        br
        br
    br
    br

    div
      - for(const _item of item.m_vList)
        div.item-container(id="DF-" + _item.DF)
          div.item-container-left
            h3.item-name= _item.NAME
            - if (_item.RSP.length)
              a(href="composeItem.html?df=" + _item.DF target="_blank")
                img.icon-full(src="img/icon_s/Texture2D/icon_item_s_" + _item.DF + ".png" alt= _item.NAME)
            - else
              img.icon-full(src="img/icon_s/Texture2D/icon_item_s_" + _item.DF + ".png" alt= _item.NAME)

            p= _item.DESC
            br
            p DF: #{_item.DF}
            p 種類: #{Option.itemCategoryLookUp[_item.CATEG]}
            p
              span.wealth-container
                span 売却
                img(src="img/icon_item01/Texture2D/icon_item01_00002.png" alt="エーテル")
                span= _item.RST.MN
            - if (_item.EQU_BRD)
              p 性別: 
                - if (!_item.EQU_GND.length || _item.EQU_GND.some(p => !p.GEN))
                  span ♂ ♀
                - else 
                  - if (_item.EQU_GND.some(p => p.GEN === 1 && p.ENB))
                    span ♂ 
                  - if (_item.EQU_GND.some(p => p.GEN === 2 && p.ENB))
                    span ♀ 
              - if (_item.WPN_KIND)
                p 武器種類: #{Option.weaponKindLookUp[_item.WPN_KIND] || _item.WPN_KIND}
              - if (_item.GROUP_DF)
                - const _chara = chara.m_vList.find(p => p.GROUP_DF === _item.GROUP_DF)
                p キャラクター專用
                p
                  a(href="chara.html#DF-" + _chara.DF target="_blank")
                    img.icon-small(src="img/chara/Texture2D/icon_chara_all_" + _chara.DF.toString().padStart(4, "0") + "_00.png" alt= _chara.NAME)


          div.item-container-right
            - const _fieldItem = fieldItem.List.find(p => p.iItemId === _item.DF)
            - if (_fieldItem)
              h4 ---- 戦闘用 ----
              p 目標: #{Option.FieldItemRangeLookUp[_fieldItem.eRange]}
              p 効果: #{Option.fieldItemUseLookUp[_fieldItem.eUse]}
              - for (const [i, stateId] of _fieldItem.eStateList.filter(p => p).entries())
                - const _abnormalState = abnormalState.m_vList.find(p => p.id === stateId)
                p= _abnormalState.name
                p #{_abnormalState.turn} ターン
                - if (_fieldItem.eStateList.length !== (i + 1))
                  p &gt;

            - if (_item.RSP.length)
              h4 ----- 調合條件 -----
              - if (_item.ALT.LV)
                p 錬金 LV #{_item.ALT.LV}
                p
                  span.wealth-container
                    img(src="img/icon_item01/Texture2D/icon_item01_00002.png" alt="エーテル")
                    span= _item.ALT.CST
              table
                tr
                  - for (const rsp of _item.RSP)
                    td
                      a(href="#DF-" + rsp.DF)
                        img.icon-small(src="img/icon_s/Texture2D/icon_item_s_" + rsp.DF + ".png" alt= rsp.DF)
                    td x#{rsp.NC}


            - const makeItem = itemsOrderByCategory.filter(p => p.RSP.some(j => j.DF === _item.DF))
            - if (makeItem.length)
              h4 ----- 材料 -----
              div.item-making-container
                - for (const otherItem of makeItem)
                  div
                    a(href="#DF-" + otherItem.DF)
                      img.icon-small(src="img/icon_s/Texture2D/icon_item_s_" + otherItem.DF + ".png" alt= otherItem.DF)

            - if (_item.SPC.length)
              - for (const spc of _item.SPC)
                h4 ----- スキル/効果 (品質 #{spc.THR}) -----
                - for (const [i, spcSkill] of spc.SKILL.entries())
                  - const _skill = skill.m_vList.find(s => s.id === spcSkill.DF);
                  - if (!_skill)
                    - if (spcSkill.DF)
                      p skill not found: DF=#{spcSkill.DF}
                    - else
                      p -
                  - else
                    table
                      tr
                        th 名前
                        td= _skill.name
                      tr
                        th 詳細
                        td= _skill.detail
                      tr
                        th 数値
                        td= `${_skill.effectValue}, ${_skill.effectValue2}`
                      - if (_skill.stateOwn.length)
                        tr
                          th 追加状態 (友)
                          td
                            - for (const _state of _skill.stateOwn)
                              - const _abnormalState = abnormalState.m_vList.find(p => p.id === _state.id)
                              p #{_state.rate * 100}% #{_abnormalState.name} #{_state.rate}ターン
                      - if (_skill.state.length)
                        tr
                          th 追加状態 (敵)
                          td
                            - for (const _state of _skill.state)
                              - const _abnormalState = abnormalState.m_vList.find(p => p.id === _state.id)
                              p #{_state.rate * 100}% #{_abnormalState.name} #{_state.rate}ターン
                  - if (spc.SKILL.length !== (i + 1))
                    p &#x3E;

            - if (_item.EQU_BRD && Object.values(_item.ELM).filter(p => p).length)
              h4 ----- 屬性 -----
              table
                - for (const [element, value] of Object.entries(_item.ELM).filter(p => p[1]))
                  tr
                    th= Option.elementLookUp[element] || element
                    td= value

              - for (const lv of [1, 60, 80])
                h4 ----- LV #{lv} -----
                table
                  tr
                    th= Option.stateLookUp.SATK
                    td= LogicHelper.calculateState(_item.EQU.SATK, lv)
                  tr
                    th= Option.stateLookUp.SDEF
                    td= LogicHelper.calculateState(_item.EQU.SDEF, lv)
                  tr
                    th= Option.stateLookUp.MATK
                    td= LogicHelper.calculateState(_item.EQU.MATK, lv)
                  tr
                    th= Option.stateLookUp.MDEF
                    td= LogicHelper.calculateState(_item.EQU.MDEF, lv)
                  tr
                    th= Option.stateLookUp.SPD
                    td= LogicHelper.calculateState(_item.EQU.SPD, lv)
                  tr
                    th= Option.stateLookUp.SDA
                    td= LogicHelper.calculateState(_item.EQU.SDA, lv)
                  tr
                    th= Option.stateLookUp.LDA
                    td= LogicHelper.calculateState(_item.EQU.LDA, lv)
                  tr
                    th= Option.stateLookUp.QTH
                    td= LogicHelper.calculateState(_item.EQU.QTH, lv)
                  tr
                    th= Option.stateLookUp.DDG
                    td= LogicHelper.calculateState(_item.EQU.DDG, lv)
                  tr
                    th= Option.stateLookUp.SADD
                    td= LogicHelper.calculateState(_item.EQU.SADD, lv)
        hr
