<!DOCTYPE html>
<html>

<head>
  <title>キャラクタービルダー</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/characterBuilder.css">
  <script src="https://cdn.jsdelivr.net/npm/linq@3.2.3/linq.min.js" integrity="sha256-wNfOgqZN3b4Ddw/AMdNgAqUulgfVw9e96maWCY30eBU=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue"></script>

  <script src="https://unpkg.com/vue-select@latest"></script>

  <link rel="stylesheet" href="https://unpkg.com/vue-select@latest/dist/vue-select.css">
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <script src="https://unpkg.com/element-ui/lib/index.js"></script>

  <script src="https://unpkg.com/v-tooltip"></script>
</head>

<body>
  <div id="app">
    <el-dialog title="" :visible.sync="itemPickerDialogVisible" fullscreen>
      <div class="item-picker-container">
        <el-select v-if="itemPickerShowSort" v-model="itemPickerSort" placeholder="Sort" filterable clearable>
          <el-option v-for="item in itemPickerSortOption" :key="item.value" :label="item.label" :value="item.value"></el-option>
        </el-select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <span>show info</span>
        <el-switch v-model="itemPickerShowStates"></el-switch>
        <el-input v-model="itemPickerFilterKeyword" placeholder="名前 / DF"></el-input>
        <div class="item-picker-items">
          <div v-if="itemPickerShowRemoveIcon" class="item-picker-remove-item" @click="onPickItem()">
            <img class="icon-small" src="img/icon_s/Texture2D/icon_item_s_10790001.png">
          </div>
          <div @click="onPickItem(item)" v-for="item in getFilteredItemPickerItems()" :key="item.DF">
            <v-popover placement="right-end" trigger="hover">
              <p>{{ item.NAME }}</p>
              <img class="icon-small" :src="'img/icon_s/Texture2D/icon_item_s_' + item.DF + '.png'">
              <template v-if="itemPickerShowStates" slot="popover">
                <div class="equipment-popover">
                  <table>
                    <tr v-for="_item in getItemStates(item)" :key="_item.label">
                      <th>{{ _item.label }}</th>
                      <td>{{ _item.value }}{{ _item.skillValue ? ` ${getNumberSignText(_item.skillValue)} ${_item.skillValue}` : '' }}</td>
                    </tr>
                    <tr v-for="info in [getItemDodge(item)].filter(p => p.skills.length)">
                      <th>回避</th>
                      <td>{{ getItemDodge(item).value }}</td>
                    </tr>
                    <tr v-for="info in [getItemCriticalHit(item)].filter(p => p.skills.length)">
                      <th>クリティカル</th>
                      <td>{{ info.value }}</td>
                    </tr>
                    <tr v-for="element in getItemElements(item)" :key="element.label">
                      <th>{{ element.label }}</th>
                      <td>{{ element.value }}{{ element.skillValue ? ` ${getNumberSignText(element.skillValue)} ${element.skillValue}` : '' }}</td>
                    </tr>
                  </table>
                  <br>
                  <div v-for="skill in getItemSkills(item)" :key="skill.id">
                    <p>{{ skill.name }}</p>
                    <p>{{ skill.detail }}</p>
                    <p>&#x3E;</p>
                  </div>
                </div>
              </template>
            </v-popover>
          </div>
        </div>
      </div>
    </el-dialog>


    <el-dialog title="" :visible.sync="supportItemEditDialogVisible" width="80%">
      <div class="support-item-edit-dialog">
        <div class="support-item-picker" v-if="supportItemSelected">
          <img class="icon-small" :src="'img/icon_s/Texture2D/icon_item_s_' + supportItemSelected.DF + '.png'" :alt="supportItemSelected.name">
          <el-button @click="itemPickerDialogVisible = true">Pick Item</el-button>
          <el-button @click="onAddSupportItem">Add</el-button>
        </div>
        <div>
          <p>
            LV 全設定 <el-input-number v-model="supportItemAllLevel" :min="1" size="small" step-strictly></el-input-number>
            <el-button @click="onSetAllSupportItemLevel" type="primary">確認</el-button>
          </p>
        </div>
        <div>Total: {{ player.supports.length }}</div>
        <table>
          <tr v-for="summary in getSupportItemStatesSummary()" :key="summary.state">
            <th>{{ summary.label }}</th>
            <th>{{ summary.value }}</th>
          </tr>
          <tr v-for="summary in getSupportItemElementSummary()" :key="summary.element">
            <th>{{ summary.label }}</th>
            <th>{{ summary.value }}</th>
          </tr>
        </table>
        <div class="support-item-editor-items">
          <div v-for="(item, i) in player.supports" :key="i">
            <p>
              <el-input-number v-model="player.supportModifier[i].level" :min="0" size="small" step-strictly></el-input-number>
              <el-button @click="onRemoveSupportItem(i)" type="danger" icon="el-icon-delete" circle></el-button>
            </p>
            <p>
              <img class="icon-small" :src="'img/icon_s/Texture2D/icon_item_s_' + item.DF + '.png'">
            </p>
            <table>
              <tr v-for="state in getSupportItemStates(i)">
                <th>{{ state.label }}</th>
                <td>{{ getNumberSignText(state.value) }}{{ state.value }}</td>
              </tr>
              <tr v-for="element in getSupportItemElements(i)">
                <th>{{ element.label }}</th>
                <td>{{ getNumberSignText(element.value) }}{{ element.value }}</td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </el-dialog>



    <el-dialog title="" :visible.sync="characterEditDialogVisible" width="80%">
      <div class="character-edit-dialog">
        <div class="character-picker">
          <div @click="onPickCharacter()">
            <img src="img/icon_s/Texture2D/icon_item_s_10790001.png">
          </div>
          <div :class="{ 'selected-character': player.character && character.DF === player.character.DF }" @click="onPickCharacter(character)" v-for="character in characters" :key="character.DF">
            <img :src="getCharacterImage(character)" :alt="character.NAME">
          </div>
        </div>
        <div class="character-state">
          <div v-if="player.character">
            <h3>{{ player.character.NAME }}</h3>
            <img class="character-image" :src="getCharacterImage(player.character)" :alt="player.character.NAME">
            <table>
              <tr>
                <th>LV</th>
                <td>
                  <el-input-number v-model="player.characterModifier.level" :min="1" size="small" step-strictly></el-input-number>
                </td>
              </tr>
              <tr>
                <th>食事 LV</th>
                <td><el-input-number v-model="player.characterModifier.foodLevel" :min="1" :max="player.characterModifier.level" size="small" step-strictly></el-input-number></td>
              </tr>
              <tr>
                <th>BlazeArt LV</th>
                <td>
                  <el-input-number v-model="player.characterModifier.blazeArtLevel" label="" :min="0" :max="player.character.BA.length ? 5 : 1" size="small" step-strictly></el-input-number>
                </td>
              </tr>
            </table>
            <table>

              <tr v-for="characterState in getCharacterStates()" :key="characterState.state">
                <th>
                  <v-popover placement="right-end" trigger="hover">
                    <span>{{ characterState.label }}</span>
                    <template slot="popover">
                      <div class="character-state-popover">
                        <table>
                          <tr>
                            <th>base</th>
                            <td>{{ characterState.value }}</td>
                          </tr>
                          <tr>
                            <th>food</th>
                            <td>{{ characterState.foodValue }}</td>
                          </tr>
                          <tr v-if="characterState.skills.length">
                            <th>skill</th>
                            <td>
                              <p v-for="skill in characterState.skills" :key="skill.id">
                                {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </th>
                <td>
                  <v-popover placement="right-end" trigger="hover">
                    <span>{{ characterState.value + characterState.foodValue + characterState.skillValue }}</span>
                    <template slot="popover">
                      <div class="character-state-popover">
                        <table>
                          <tr>
                            <th>base</th>
                            <td>{{ characterState.value }}</td>
                          </tr>
                          <tr>
                            <th>food</th>
                            <td>{{ characterState.foodValue }}</td>
                          </tr>
                          <tr v-if="characterState.skills.length">
                            <th>skill</th>
                            <td>
                              <p v-for="skill in characterState.skills" :key="skill.id">
                                {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </td>
              </tr>


              <tr>
                <th>
                  <v-popover placement="right-end" trigger="hover">
                    <span>回避</span>
                    <template v-if="getCharacterDodgeWithDetail().skills.length" slot="popover">
                      <div class="character-state-popover">
                        <table>
                           <tr>
                            <th>skill</th>
                            <td>
                              <p v-for="skill in getCharacterDodgeWithDetail().skills" :key="skill.id">
                                {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </th>
                <td>
                  <v-popover placement="right-end" trigger="hover">
                    <span>{{ getCharacterDodgeWithDetail().value }}</span>
                    <template v-if="getCharacterDodgeWithDetail().skills.length" slot="popover">
                      <div class="character-state-popover">
                        <table>
                           <tr>
                            <th>skill</th>
                            <td>
                              <p v-for="skill in getCharacterDodgeWithDetail().skills" :key="skill.id">
                                {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </td>
              </tr>



              <tr>
                <th>
                  <v-popover placement="right-end" trigger="hover">
                    <span>クリティカル</span>
                    <template v-if="getCharacterCriticalHitWithDetail().skills.length" slot="popover">
                      <div class="character-state-popover">
                        <table>
                           <tr>
                            <th>skill</th>
                            <td>
                              <p v-for="skill in getCharacterCriticalHitWithDetail().skills" :key="skill.id">
                                {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </th>
                <td>
                  <v-popover placement="right-end" trigger="hover">
                    <span>{{ getCharacterCriticalHitWithDetail().value }}</span>
                    <template v-if="getCharacterCriticalHitWithDetail().skills.length" slot="popover">
                      <div class="character-state-popover">
                        <table>
                           <tr>
                            <th>skill</th>
                            <td>
                              <p v-for="skill in getCharacterCriticalHitWithDetail().skills" :key="skill.id">
                                {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </td>
              </tr>



              <tr v-for="element in getCharacterElements()" :key="element.label">
                <th>
                  <v-popover placement="right-end" trigger="hover">
                    <span>{{ element.label }}</span>
                    <template v-if="element.value" slot="popover">
                      <div class="character-state-popover">
                        <table>
                          <tr>
                            <th>skill</th>
                            <td>
                              <p v-for="skill in element.skills" :key="skill.id">
                                {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </th>
                <td>
                  <v-popover placement="right-end" trigger="hover">
                    <span>{{ element.value }}</span>
                    <template v-if="element.value" slot="popover">
                      <div class="character-state-popover">
                        <table>
                          <tr>
                            <th>skill</th>
                            <td>
                              <p v-for="skill in element.skills" :key="skill.id">
                                {{ skill.id }} {{ skill.name }} {{ getNumberSignText(skill.effectValue) }}{{ skill.effectValue }}
                              </p>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </template>
                  </v-popover>
                </td>
              </tr>
            </table>

  
            <div>
              <div v-for="skill in getFilteredSkills(getCharacterSkills())" :key="skill.id">
                <v-popover placement="right-end" trigger="hover">
                  <p>{{ skill.name }}</p>
                  <template v-if="skill.detail || skill.state.length || skill.stateOwn.length" slot="popover">
                    <div class="character-skill-popover">
                      <p class="character-skill-popover-detail">{{ skill.detail }}</p>
                      <div v-for="(state in skill.state" :key="state.id">
                        <p>{{(state.rate * 100).toFixed()}}% {{ abnormalStateLookup[state.id].name }}</p>
                      </div>
                      <div v-for="(state in skill.stateOwn" :key="state.i">
                        <p>{{(state.rate * 100).toFixed()}}% {{ abnormalStateLookup[state.id].name }}</p>
                      </div>
                    </div>
                  </template>
                </v-popover>
              </div>
            </div>
          </div>
        </div>
      </div>
    </el-dialog>



    <div class="container" v-loading="pageLoading">
      <div class="main-equipment">
        <div class="left-equipment">

          <v-popover placement="right-end" trigger="hover">
            <div class="equipment-icon">
              <p>品質 {{ player.equipmentModifier.weapon.quality }} LV {{ player.equipmentModifier.weapon.level }} </p>
              <img @click="onPickWeapon()" :src="getWeaponImage()">
            </div>
            <template v-if="player.equipment.weapon" slot="popover">
              <div class="equipment-popover">
                <h3>{{ player.equipment.weapon.NAME }}</h3>
                <table>
                  <tr>
                    <th>品質</th>
                    <td>
                      <el-input-number v-model="player.equipmentModifier.weapon.quality" :min="1" size="small" step-strictly></el-input-number>
                    </td>
                  </tr>
                  <tr>
                    <th>LV</th>
                    <td><el-input-number v-model="player.equipmentModifier.weapon.level" :min="1" size="small" step-strictly></el-input-number></td>
                  </tr>
                  <!-- <tr>
                    <th>特性</th>
                    <td>
                      <el-select v-model="player.equipmentModifier.weapon.skillId" placeholder="特性" filterable clearable>
                        <el-option v-for="skill in addonSkills" :key="skill.id" :label="skill.name" :value="skill.id"></el-option>
                      </el-select>
                    </td>
                  </tr> -->
                </table>

                <table>
                  <tr v-for="item in getEquipmentStates('weapon')" :key="item.label">
                    <th>{{ item.label }}</th>
                    <td>{{ item.value }}{{ item.skillValue ? ` ${getNumberSignText(item.skillValue + item.extraValue)} ${item.skillValue + item.extraValue}` : '' }}</td>
                  </tr>
                  <tr v-if="getEquipmentDodge('weapon').skills.length">
                    <th>回避</th>
                    <td>{{ getEquipmentDodge('weapon').value }}</td>
                  </tr>
                  <tr v-if="getEquipmentCriticalHit('weapon').skills.length">
                    <th>クリティカル</th>
                    <td>{{ getEquipmentCriticalHit('weapon').value }}</td>
                  </tr>
                  <tr v-for="element in getEquipmentElements('weapon')" :key="element.label">
                    <th>{{ element.label }}</th>
                    <td>{{ element.value }}{{ element.skillValue ? ` ${getNumberSignText(element.skillValue + element.extraValue)} ${element.skillValue + element.extraValue}` : '' }}</td>
                  </tr>
                </table>
                <br>
                <div v-for="skill in getEquipmentSkills('weapon')" :key="skill.id">
                  <p>{{ skill.name }}</p>
                  <p>{{ skill.detail }}</p>
                  <p>&#x3E;</p>
                </div>
              </div>
            </template>
          </v-popover>

          <v-popover placement="right-end" trigger="hover">
            <div class="equipment-icon">
              <p>品質 {{ player.equipmentModifier.shield.quality }} LV {{ player.equipmentModifier.shield.level }} </p>
              <img @click="onPickShield()" :src="getShieldImage()">
            </div>
            <template v-if="player.equipment.shield" slot="popover">
              <div class="equipment-popover">
                <h3>{{ player.equipment.shield.NAME }}</h3>
                <table>
                  <tr>
                    <th>品質</th>
                    <td>
                      <el-input-number v-model="player.equipmentModifier.shield.quality" :min="1" size="small" step-strictly></el-input-number>
                    </td>
                  </tr>
                  <tr>
                    <th>LV</th>
                    <td><el-input-number v-model="player.equipmentModifier.shield.level" :min="1" size="small" step-strictly></el-input-number></td>
                  </tr>
                  <!-- <tr>
                    <th>特性</th>
                    <td>
                      <el-select v-model="player.equipmentModifier.shield.skillId" placeholder="特性" filterable clearable>
                        <el-option v-for="skill in addonSkills" :key="skill.id" :label="skill.name" :value="skill.id"></el-option>
                      </el-select>
                    </td>
                  </tr> -->
                </table>

                <table>
                  <tr v-for="item in getEquipmentStates('shield')" :key="item.label">
                    <th>{{ item.label }}</th>
                    <td>{{ item.value }}{{ item.skillValue ? ` ${getNumberSignText(item.skillValue + item.extraValue)} ${item.skillValue + item.extraValue}` : '' }}</td>
                  </tr>
                  <tr v-if="getEquipmentDodge('shield').skills.length">
                    <th>回避</th>
                    <td>{{ getEquipmentDodge('shield').value }}</td>
                  </tr>
                  <tr v-if="getEquipmentCriticalHit('shield').skills.length">
                    <th>クリティカル</th>
                    <td>{{ getEquipmentCriticalHit('shield').value }}</td>
                  </tr>
                  <tr v-for="element in getEquipmentElements('shield')" :key="element.label">
                    <th>{{ element.label }}</th>
                    <td>{{ element.value }}{{ element.skillValue ? ` ${getNumberSignText(element.skillValue + element.extraValue)} ${element.skillValue + element.extraValue}` : '' }}</td>
                  </tr>
                </table>
                <br>
                <div v-for="skill in getEquipmentSkills('shield')" :key="skill.id">
                  <p>{{ skill.name }}</p>
                  <p>{{ skill.detail }}</p>
                  <p>&#x3E;</p>
                </div>
              </div>
            </template>
          </v-popover>


          <v-popover placement="right-end" trigger="hover">
            <div class="equipment-icon">
              <p>品質 {{ player.equipmentModifier.helmet.quality }} LV {{ player.equipmentModifier.helmet.level }} </p>
              <img @click="onPickHelmet()" :src="getHelmetImage()">
            </div>
            <template v-if="player.equipment.helmet" slot="popover">
              <div class="equipment-popover">
                <h3>{{ player.equipment.helmet.NAME }}</h3>
                <table>
                  <tr>
                    <th>品質</th>
                    <td>
                      <el-input-number v-model="player.equipmentModifier.helmet.quality" :min="1" size="small" step-strictly></el-input-number>
                    </td>
                  </tr>
                  <tr>
                    <th>LV</th>
                    <td><el-input-number v-model="player.equipmentModifier.helmet.level" :min="1" size="small" step-strictly></el-input-number></td>
                  </tr>
                  <!-- <tr>
                    <th>特性</th>
                    <td>
                      <el-select v-model="player.equipmentModifier.helmet.skillId" placeholder="特性" filterable clearable>
                        <el-option v-for="skill in addonSkills" :key="skill.id" :label="skill.name" :value="skill.id"></el-option>
                      </el-select>
                    </td>
                  </tr> -->
                </table>

                <table>
                  <tr v-for="item in getEquipmentStates('helmet')" :key="item.label">
                    <th>{{ item.label }}</th>
                    <td>{{ item.value }}{{ item.skillValue ? ` ${getNumberSignText(item.skillValue + item.extraValue)} ${item.skillValue + item.extraValue}` : '' }}</td>
                  </tr>
                  <tr v-if="getEquipmentDodge('helmet').skills.length">
                    <th>回避</th>
                    <td>{{ getEquipmentDodge('helmet').value }}</td>
                  </tr>
                  <tr v-if="getEquipmentCriticalHit('helmet').skills.length">
                    <th>クリティカル</th>
                    <td>{{ getEquipmentCriticalHit('helmet').value }}</td>
                  </tr>
                  <tr v-for="element in getEquipmentElements('helmet')" :key="element.label">
                    <th>{{ element.label }}</th>
                    <td>{{ element.value }}{{ element.skillValue ? ` ${getNumberSignText(element.skillValue + element.extraValue)} ${element.skillValue + element.extraValue}` : '' }}</td>
                  </tr>
                </table>
                <br>
                <div v-for="skill in getEquipmentSkills('helmet')" :key="skill.id">
                  <p>{{ skill.name }}</p>
                  <p>{{ skill.detail }}</p>
                  <p>&#x3E;</p>
                </div>
              </div>
            </template>
          </v-popover>



          <v-popover placement="right-end" trigger="hover">
            <div class="equipment-icon">
              <p>品質 {{ player.equipmentModifier.cloth.quality }} LV {{ player.equipmentModifier.cloth.level }} </p>
              <img @click="onPickCloth()" :src="getClothImage()">
            </div>
            <template v-if="player.equipment.cloth" slot="popover">
              <div class="equipment-popover">
                <h3>{{ player.equipment.cloth.NAME }}</h3>
                <table>
                  <tr>
                    <th>品質</th>
                    <td>
                      <el-input-number v-model="player.equipmentModifier.cloth.quality" :min="1" size="small" step-strictly></el-input-number>
                    </td>
                  </tr>
                  <tr>
                    <th>LV</th>
                    <td><el-input-number v-model="player.equipmentModifier.cloth.level" :min="1" size="small" step-strictly></el-input-number></td>
                  </tr>
                  <!-- <tr>
                    <th>特性</th>
                    <td>
                      <el-select v-model="player.equipmentModifier.cloth.skillId" placeholder="特性" filterable clearable>
                        <el-option v-for="skill in addonSkills" :key="skill.id" :label="skill.name" :value="skill.id"></el-option>
                      </el-select>
                    </td>
                  </tr> -->
                </table>

                <table>
                  <tr v-for="item in getEquipmentStates('cloth')" :key="item.label">
                    <th>{{ item.label }}</th>
                    <td>{{ item.value }}{{ item.skillValue ? ` ${getNumberSignText(item.skillValue + item.extraValue)} ${item.skillValue + item.extraValue}` : '' }}</td>
                  </tr>
                  <tr v-if="getEquipmentDodge('cloth').skills.length">
                    <th>回避</th>
                    <td>{{ getEquipmentDodge('cloth').value }}</td>
                  </tr>
                  <tr v-if="getEquipmentCriticalHit('cloth').skills.length">
                    <th>クリティカル</th>
                    <td>{{ getEquipmentCriticalHit('cloth').value }}</td>
                  </tr>
                  <tr v-for="element in getEquipmentElements('cloth')" :key="element.label">
                    <th>{{ element.label }}</th>
                    <td>{{ element.value }}{{ element.skillValue ? ` ${getNumberSignText(element.skillValue + element.extraValue)} ${element.skillValue + element.extraValue}` : '' }}</td>
                  </tr>
                </table>
                <br>
                <div v-for="skill in getEquipmentSkills('cloth')" :key="skill.id">
                  <p>{{ skill.name }}</p>
                  <p>{{ skill.detail }}</p>
                  <p>&#x3E;</p>
                </div>
              </div>
            </template>
          </v-popover>

        </div>
        <div class="right-equipment">
          <v-popover v-for="i in [...new Array(3).keys()].map(p => p +1)" :key="i" placement="right-end" trigger="hover">
            <div class="equipment-icon">
              <p>品質 {{ player.equipmentModifier['accessory' + i].quality }} LV {{ player.equipmentModifier['accessory' + i].level }} </p>
              <img @click="onPickAccessory(i)" :src="getAccessoryImage(i)">
            </div>
            <template v-if="player.equipment['accessory' + i]" slot="popover">
              <div class="equipment-popover">
                <h3>{{ player.equipment['accessory' + i].NAME }}</h3>
                <table>
                  <tr>
                    <th>品質</th>
                    <td>
                      <el-input-number v-model="player.equipmentModifier['accessory' + i].quality" :min="1" size="small" step-strictly></el-input-number>
                    </td>
                  </tr>
                  <tr>
                    <th>LV</th>
                    <td><el-input-number v-model="player.equipmentModifier['accessory' + i].level" :min="1" size="small" step-strictly></el-input-number></td>
                  </tr>
                  <!-- <tr>
                    <th>特性</th>
                    <td>
                      <el-select v-model="player.equipmentModifier['accessory' + i].skillId" placeholder="特性" filterable clearable>
                        <el-option v-for="skill in addonSkills" :key="skill.id" :label="skill.name" :value="skill.id"></el-option>
                      </el-select>
                    </td>
                  </tr> -->
                </table>

                <table>
                  <tr v-for="item in getEquipmentStates('accessory' + i)" :key="item.label">
                    <th>{{ item.label }}</th>
                    <td>{{ item.value }}{{ item.skillValue ? ` ${getNumberSignText(item.skillValue + item.extraValue)} ${item.skillValue + item.extraValue}` : '' }}</td>
                  </tr>
                  <tr v-if="getEquipmentDodge('accessory' + i).skills.length">
                    <th>回避</th>
                    <td>{{ getEquipmentDodge('accessory' + i).value }}</td>
                  </tr>
                  <tr v-if="getEquipmentCriticalHit('accessory' + i).skills.length">
                    <th>クリティカル</th>
                    <td>{{ getEquipmentCriticalHit('accessory' + i).value }}</td>
                  </tr>
                  <tr v-for="element in getEquipmentElements('accessory' + i)" :key="element.label">
                    <th>{{ element.label }}</th>
                    <td>{{ element.value }}{{ element.skillValue ? ` ${getNumberSignText(element.skillValue + element.extraValue)} ${element.skillValue + element.extraValue}` : '' }}</td>
                  </tr>
                </table>
                <br>
                <div v-for="skill in getEquipmentSkills('accessory' + i)" :key="skill.id">
                  <p>{{ skill.name }}</p>
                  <p>{{ skill.detail }}</p>
                  <p>&#x3E;</p>
                </div>
              </div>
            </template>
          </v-popover>
        </div>
      </div>







      <div class="sub-equipment">
        <div class="sub-equipment-menu">
          <p style="text-align: center">
            <span>Support x {{ player.supports.length }}</span>
            <el-button @click="openSupportItemEditDialog" type="success" icon="el-icon-edit" circle></el-button>
          </p>
        </div>
        <div class="sub-equipment-items">
          <div v-for="(item, i) in player.supports" :key="i">
            <v-popover placement="right-end" trigger="hover">
              <img :src="'img/icon_s/Texture2D/icon_item_s_' + item.DF + '.png'">
              <template slot="popover">
                <div class="equipment-popover">
                  <h3>{{ item.NAME }} (LV {{ player.supportModifier[i].level }})</h3>
                  <table>
                    <tr v-for="state in getSupportItemStates(i)">
                      <th>{{ state.label }}</th>
                      <td>{{ getNumberSignText(state.value) }}{{ state.value }}</td>
                    </tr>
                    <tr v-for="element in getSupportItemElements(i)">
                      <th>{{ element.label }}</th>
                      <td>{{ getNumberSignText(element.value) }}{{ element.value }}</td>
                    </tr>
                  </table>
                </div>
              </template>
            </v-popover>
          </div>
        </div>
      </div>





      <div class="result">
        <div class="character">
          <div>
            <h4>
              <span>
                <el-button @click="characterEditDialogVisible = true" type="primary" icon="el-icon-edit" circle></el-button>
              </span>
              <span v-if="player.character">
                {{ player.character.NAME }} (LV {{ player.characterModifier.level }}) (食事 LV {{ player.characterModifier.foodLevel }})  (BA LV {{ player.characterModifier.blazeArtLevel }})
              </span>
            </h4>
            <img v-if="player.character" :src="getCharacterImage()" :alt="player.character.NAME">
          </div>
        </div>

        <table :set="temp = getSummaryState()">
          <tr v-for="summary in temp.totalStates" :key="summary.state">
            <th>{{ summary.label }}</th>
            <td>{{ summary.value }}</td>
          </tr>
          <tr>
            <th>回避</th>
            <td>{{ temp.totalDodgeState }}</td>
          </tr>
          <tr>
            <th>クリティカル</th>
            <td>{{ temp.totalCriticalHitState }}</td>
          </tr>
          <tr v-for="element in temp.totalElements" :key="element.label">
            <th>{{ element.label }}</th>
            <td>{{ element.value }}</td>
          </tr>
          <tr>
            <th>SKILL</th>
            <td>{{ 100 + temp.skillMultiplier * 100 }}%</td>
          </tr>
        </table>
      </div>
    </div>
  </div>
  <script src="js/characterBuilder.js"></script>
  <div>
    <p>開発中です</p>
    <p>skill/属性/効果 may not working</p>
  </div>
</body>

</html>